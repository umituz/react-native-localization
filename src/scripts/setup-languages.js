#!/usr/bin/env node

/**
 * Setup Languages Script
 * Generates index.ts with all available translation files
 * Usage: node setup-languages.js [locales-dir]
 */

const fs = require('fs');
const path = require('path');

function main() {
  const targetDir = process.argv[2] || 'src/domains/localization/translations';
  const localesDir = path.resolve(process.cwd(), targetDir);

  console.log('ðŸš€ Setting up language files...\n');
  console.log(`ðŸ“‚ Locales directory: ${localesDir}\n`);

  if (!fs.existsSync(localesDir)) {
    console.error(`âŒ Locales directory not found: ${localesDir}`);
    process.exit(1);
  }

  const files = fs.readdirSync(localesDir)
    .filter(f => f.match(/^[a-z]{2}-[A-Z]{2}\.ts$/))
    .sort();

  console.log(`ðŸ“Š Found ${files.length} language files:\n`);

  const imports = [];
  const exports = [];

  files.forEach(file => {
    const code = file.replace('.ts', '');
    const varName = code.replace(/-([a-z0-9])/g, (g) => g[1].toUpperCase()).replace('-', '');

    console.log(`   ðŸ“„ ${code}`);
    imports.push(`import ${varName} from "./${code}";`);
    exports.push(`  "${code}": ${varName},`);
  });

  const content = `/**
 * Localization Index
 * Exports all available translation files
 * Auto-generated by scripts/setup-languages.js
 */

${imports.join('\n')}

export const translations = {
${exports.join('\n')}
};

export type TranslationKey = keyof typeof translations;

export default translations;
`;

  const indexPath = path.join(localesDir, 'index.ts');
  fs.writeFileSync(indexPath, content);

  console.log(`\nâœ… Generated index.ts with ${files.length} languages`);
  console.log(`   Output: ${indexPath}`);
}

main();
